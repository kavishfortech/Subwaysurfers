<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KAVISH 2D SIDE-SCROLLER</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Syncopate:wght@700&family=Share+Tech+Mono&display=swap');
        :root { --neon: #00f3ff; --pink: #bc13fe; --danger: #ff2e2e; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #000; font-family: 'Share Tech Mono', monospace; overflow: hidden; height: 100vh; display: flex; justify-content: center; align-items: center; }

        /* THE RGB BOX */
        #hub { position: relative; width: 800px; height: 400px; background: #050510; border: 4px solid #fff; animation: rgbShift 3s linear infinite; overflow: hidden; }
        @keyframes rgbShift { 0% { border-color: #f00; box-shadow: 0 0 20px #f00; } 33% { border-color: #0f0; box-shadow: 0 0 20px #0f0; } 66% { border-color: #00f; box-shadow: 0 0 20px #00f; } 100% { border-color: #f00; box-shadow: 0 0 20px #f00; } }

        canvas { display: block; background: linear-gradient(#001, #005); }

        .overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.8); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; }
        .hidden { display: none !important; }

        .btn { background: none; border: 2px solid var(--neon); color: var(--neon); padding: 12px 24px; margin: 10px; font-family: 'Syncopate'; font-size: 0.7rem; cursor: pointer; }
        .btn:hover { background: var(--neon); color: #000; }
        .btn-shop { border-color: var(--pink); color: var(--pink); }

        #stats { position: absolute; top: 15px; left: 20px; color: var(--neon); font-size: 1.2rem; pointer-events: none; z-index: 5; }
    </style>
</head>
<body>

<div id="hub">
    <div id="stats">COINS: <span id="coin-val">0</span> <span id="shield-stat" style="margin-left:20px; color:var(--pink);"></span></div>
    
    <canvas id="gameCanvas"></canvas>

    <div id="start-screen" class="overlay">
        <h1 style="font-family:'Syncopate'; margin-bottom:20px;">ARCHITECT 2D</h1>
        <button class="btn" onclick="Game.start()">START RUN</button>
        <button id="shop-btn" class="btn btn-shop" onclick="Game.buyBoard()">BUY SURFBOARD (50 COINS)</button>
    </div>

    <div id="death-screen" class="overlay hidden">
        <h2 style="color:var(--danger); font-family:'Syncopate';">CRITICAL FAILURE</h2>
        <p id="final-score" style="margin: 10px 0;"></p>
        <button class="btn" onclick="Game.start()">REBOOT</button>
    </div>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = 800; canvas.height = 400;

const Game = {
    active: false, coins: 0, hasBoard: false, speed: 6,
    player: null, obstacles: [], collectibles: [], frame: 0,

    start() {
        this.active = true; this.frame = 0; this.speed = 6;
        this.player = new Player();
        this.obstacles = []; this.collectibles = [];
        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('death-screen').classList.add('hidden');
        this.loop();
    },

    buyBoard() {
        if (this.coins >= 50 && !this.hasBoard) {
            this.coins -= 50; this.hasBoard = true;
            document.getElementById('coin-val').innerText = this.coins;
            document.getElementById('shield-stat').innerText = "ðŸ›¡ï¸ SHIELD ACTIVE";
        } else { alert(this.hasBoard ? "ALREADY EQUIPPED" : "NEED 50 COINS"); }
    },

    die() {
        if (this.hasBoard) {
            this.hasBoard = false;
            document.getElementById('shield-stat').innerText = "";
            return; 
        }
        this.active = false;
        document.getElementById('death-screen').classList.remove('hidden');
        document.getElementById('final-score').innerText = "COINS COLLECTED: " + this.coins;
    },

    loop() {
        if (!this.active) return;
        ctx.clearRect(0,0,800,400);

        // Ground
        ctx.fillStyle = "#111"; ctx.fillRect(0, 350, 800, 50);
        ctx.strokeStyle = var(--neon); ctx.strokeRect(0, 350, 800, 1);

        this.player.update();
        this.player.draw();

        if (this.frame % 100 === 0) this.spawnObstacle();
        if (this.frame % 70 === 0) this.spawnCoin();

        // Update Obstacles
        for (let i = this.obstacles.length-1; i >= 0; i--) {
            let o = this.obstacles[i]; o.x -= this.speed;
            ctx.fillStyle = "red"; ctx.fillRect(o.x, o.y, o.w, o.h);
            
            // Collision (Hitbox)
            if (this.player.x < o.x + o.w && this.player.x + 30 > o.x &&
                this.player.y < o.y + o.h && this.player.y + 30 > o.y) {
                this.obstacles.splice(i,1); this.die();
            }
            if (o.x < -50) this.obstacles.splice(i,1);
        }

        // Update Coins
        for (let i = this.collectibles.length-1; i >= 0; i--) {
            let c = this.collectibles[i]; c.x -= this.speed;
            ctx.fillStyle = "yellow"; ctx.beginPath(); ctx.arc(c.x, c.y, 8, 0, Math.PI*2); ctx.fill();
            
            if (Math.hypot(this.player.x+15 - c.x, this.player.y+15 - c.y) < 25) {
                this.coins += 5; document.getElementById('coin-val').innerText = this.coins;
                this.collectibles.splice(i,1);
            }
            if (c.x < -20) this.collectibles.splice(i,1);
        }

        this.frame++; this.speed += 0.001;
        requestAnimationFrame(() => this.loop());
    },

    spawnObstacle() {
        let h = 30 + Math.random() * 50;
        this.obstacles.push({ x: 850, y: 350 - h, w: 30, h: h });
    },

    spawnCoin() {
        this.collectibles.push({ x: 850, y: 200 + Math.random() * 100 });
    }
};

class Player {
    constructor() {
        this.x = 100; this.y = 320; this.dy = 0;
        this.jumpCount = 0; this.gravity = 0.8;
    }
    update() {
        this.dy += this.gravity; this.y += this.dy;
        if (this.y > 320) { this.y = 320; this.dy = 0; this.jumpCount = 0; }
    }
    draw() {
        ctx.fillStyle = Game.hasBoard ? "var(--pink)" : "var(--neon)";
        ctx.fillRect(this.x, this.y, 30, 30);
        if (Game.hasBoard) { ctx.fillStyle="#fff"; ctx.fillRect(this.x-5, this.y+25, 40, 5); }
    }
    jump() {
        if (this.jumpCount < 2) { this.dy = -13; this.jumpCount++; }
    }
}

window.addEventListener('keydown', (e) => {
    if (e.key === "ArrowUp" || e.key === " ") { e.preventDefault(); Game.player.jump(); }
});
</script>
</body>
</html>
